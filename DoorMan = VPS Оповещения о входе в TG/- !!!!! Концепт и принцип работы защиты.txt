

Суть: Защита VPS и данных проекта от входа посторонних. Для ненадежных VPS.

Дано:
VPS Windows
Контейнер VeraCrypt внутри которого запущен веб-сервер с проектом.
Мощный ScreenLocker.  Экран заблокирован пока не введешь пароль. Никакие диспетчеры, cmd и тд не помогут обойти.

====

В систему заливаются эти скрипты и настраиваются переменные (целевой сайт, имя деда и тд)
В планировщике задач импортируются таски и триггеры.

Теперь при каждом заходе в систему будет отправляться сообщение в TG о том кто, куда и откуда зашел.
+ идет обратный отсчет 30сек, что бы ввести пароль и руками отменить перезагрузку(закрыть окно CMD).
Отменить перезагрузку можно только зная пароль от локера.

Если таймер вышел - уходит сообщение в TG + мгновенный принудительный ребут VPS.
!!! Контейнер с проектом закрывается. Никто не сможет получить доступ к исходникам или БД.

Для того, что бы не компроментировать свои адреса бота и юзера в TG
 - запрос отправляется не напрямую, а на сайт со специальным скриптом-обработчиком(приложен тут, написан на коленке).
Все ценные данные и токены лежат там, а не на VPS.
Для хостования хватит самого простецкого хостинга. Требований к окружению нет.

====

Что останется на руках после:
- Зашифрованный криптоконтейнер с сервом внутри, с мощным паролем.
- Отключенные логи в системе (их не будет)
- Факты подключений к VPS в логах хостера, но все заходы были с VPN
- Скрипты дормена. (ничего ценного)
- Домен куда уходили запросы.  (из настроек дормена)
- Домены, делегированные на деда. (Пробить DNS по A=IP)
- Хозяин деда уведомлен о ситуации и знает все подробности включая кто заходил.
- Кэш картинок проводника
- Кэш путей проводника, но не сам контент

Таким образом даже перезагрузив деда и зайдя на него повторно не получится идентифицировать реального владельца или влезть в проект.
Даже зная об этой системе не получится обойти ее со стороны поставщика(напр авторизуясь от сисадмина), тк триггеры все равно сработают.
Смонтированный контейнер нельзя достать ниоткуда, кроме текущей учетки. (например зайти в соседнюю и зайти на диск не получится)

====

Технические примечания:
- Планировщик может дернуть только .bat,  поэтому приходится вызывать .ps1 из него
- Все пишется на ps1 тк он намноооого лучше батников для програмирования логики + там есть спец функции.
- По дефолту дормен лежит в корне С.  Иначе руками менять все пути в вызовах.

123